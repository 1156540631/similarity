char error[1024];
ost -> st -> disposition = ist -> st -> disposition;
ost -> st -> avg_frame_rate = ist -> st -> avg_frame_rate;
ost -> enc = avcodec_find_encoder(codec -> codec_id);
ost -> frame_rate = ost -> enc -> supported_framerates[idx];
codec -> channels = avfilter_link_get_channels(ost -> filter -> filter -> inputs[0]);
ost -> frame_rate = av_buffersink_get_frame_rate(ost -> filter -> filter);
int idx = av_find_nearest_q_idx(ost -> frame_rate,ost -> enc -> supported_framerates);
if (!strcmp(ost -> enc -> name,"libx264")) {
if (ist = get_input_stream(ost)) {
snprintf(error,sizeof(error),"Error while opening encoder for output stream #%d:%d - maybe incorrect parameters such as bit_rate, rate, width or height",ost -> file_index,ost -> index);
av_buffersink_set_frame_size(ost -> filter -> filter,(ost -> st -> codec -> frame_size));
if (ist = get_input_stream(ost)) {
static InputStream *get_input_stream(OutputStream *ost)
if (ist = get_input_stream(ost)) {
snprintf(error,sizeof(error),"Error while opening encoder for output stream #%d:%d - maybe incorrect parameters such as bit_rate, rate, width or height",ost -> file_index,ost -> index);
static InputStream *get_input_stream(OutputStream *ost)
if (ist = get_input_stream(ost)) {
static InputStream *get_input_stream(OutputStream *ost)
if (ist = get_input_stream(ost)) {
static InputStream *get_input_stream(OutputStream *ost)
if (ist = get_input_stream(ost)) {
static InputStream *get_input_stream(OutputStream *ost)
if (ist = get_input_stream(ost)) {
static InputStream *get_input_stream(OutputStream *ost)
if (ist = get_input_stream(ost)) {
static InputStream *get_input_stream(OutputStream *ost)
if (ist = get_input_stream(ost)) {
static InputStream *get_input_stream(OutputStream *ost)
if (ist = get_input_stream(ost)) {
static InputStream *get_input_stream(OutputStream *ost)
if (ist = get_input_stream(ost)) {
static InputStream *get_input_stream(OutputStream *ost)
if (ist = get_input_stream(ost)) {
snprintf(error,sizeof(error),"Error while opening encoder for output stream #%d:%d - maybe incorrect parameters such as bit_rate, rate, width or height",ost -> file_index,ost -> index);
